<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>INDIGIS â€” Create Workspace</title>

  <!-- keep your global theme file -->
  <link rel="stylesheet" href="styles.css" />

  <style>
    /* ----------------------------
       Hybrid Premium + Cinematic
       (embedded, uses your CSS variables)
       ---------------------------- */

    :root {
      --fade: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.08));
    }

    /* full page cinematic backdrop (subtle, performant) */
    body {
      min-height: 100vh;
      margin: 0;
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: radial-gradient(1200px 600px at 12% 25%, rgba(123,97,255,0.06), transparent 12%),
                  radial-gradient(900px 500px at 88% 70%, rgba(41,121,255,0.045), transparent 12%),
                  var(--ui-bg);
      color: var(--text);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    /* decorative faint stars/particles using CSS repeating-radial */
    .cinema-bg {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 0;
      background-image:
        radial-gradient(circle at 5% 10%, rgba(255,255,255,0.06) 0.5px, transparent 1px),
        radial-gradient(circle at 30% 40%, rgba(255,255,255,0.04) 0.6px, transparent 1px),
        radial-gradient(circle at 80% 20%, rgba(255,255,255,0.03) 0.6px, transparent 1px);
      background-size: 60px 60px, 120px 120px, 90px 90px;
      opacity: 0.6;
      mix-blend-mode: screen;
      animation: slowFloat 18s linear infinite;
      filter: blur(.4px) contrast(.95);
    }

    @keyframes slowFloat {
      from { transform: translateY(0px) }
      50% { transform: translateY(-6px) }
      to { transform: translateY(0px) }
    }

    /* watermark / subtle brand glyph */
    .watermark {
      position: fixed;
      right: 18px;
      bottom: 32px;
      font-size: 12px;
      text-transform: uppercase;
      color: rgba(255,255,255,0.04);
      z-index: 1;
      pointer-events: none;
      letter-spacing: 1px;
    }

    /* container centers content, sits above decoration */
    .workspace-screen {
      position: relative;
      z-index: 2;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 36px;
    }

    /* top header branding (small, elegant) */
    .brand-header {
      position: absolute;
      top: 18px;
      left: 22px;
      display: flex;
      align-items: center;
      gap: 10px;
      z-index: 6;
    }
 
   /* Hover Glow for INDIGIS Logo */
.brand-mark {
  width: 48px;
  height: 48px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 12px;
  overflow: hidden;
  background: transparent !important;
  box-shadow: 0 4px 12px rgba(0,0,0,0.35);
  transition: box-shadow .25s ease, transform .25s ease;
  cursor: pointer;
}

.brand-mark img {
  width: 100%;
  height: 100%;
  object-fit: contain;
  padding: 4px;
  transition: transform .25s ease;
}

/* HOVER EFFECT */
.brand-mark:hover {
  box-shadow: 0 0 16px rgba(41,121,255,0.55), 
              0 0 28px rgba(123,97,255,0.45);
  transform: translateY(-2px) scale(1.05);
}

.brand-mark:hover img {
  transform: scale(1.08);
}


    .brand-title {
  font-size: 17px;
  font-weight: 700;
  margin-bottom: -1px;
}

   .brand-sub {
  font-size: 12px;
  color: var(--muted);
  margin-top: 2px;
  letter-spacing: 0.2px;
}

    /* THE CARD */
    .workspace-card {
      width: 820px;
      max-width: calc(100% - 64px);
      border-radius: 14px;
      padding: 34px;
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.06));
      border: 1px solid rgba(255,255,255,0.04);
      box-shadow: 0 30px 80px rgba(2,6,12,0.6), 0 8px 24px rgba(41,121,255,0.02);
      backdrop-filter: blur(14px) saturate(1.1);
      transform-origin: center;
      animation: reveal 520ms cubic-bezier(.2,.9,.2,1);
      position: relative;
      z-index: 3;
    }

    @keyframes reveal {
      from { opacity: 0; transform: translateY(18px) scale(.995) }
      to   { opacity: 1; transform: translateY(0) scale(1) }
    }

    .workspace-card .top {
      display:flex;align-items:flex-start;gap:18px;margin-bottom:6px;
    }
    .workspace-card h2 {
      margin:0;
      font-size:28px;
      letter-spacing:0.2px;
    }
    .workspace-card p.lead {
      margin:8px 0 18px;color:var(--muted);max-width:66%;
      line-height:1.5;font-size:15px;
    }

    /* layout of form - left column wide, right column controls */
    .ws-form {
      display:grid;
      grid-template-columns: 1fr 360px;
      gap: 18px;
      align-items:start;
    }

    /* left: form fields stacked */
    .form-stack { display:flex;flex-direction:column;gap:14px; }

    .field {
      display:flex;flex-direction:column;gap:6px;
    }
    .field label { font-weight:600; color:var(--muted); font-size:13px; }
    .field input, .field select {
      padding: 12px 14px;
      border-radius: 10px;
      border: 1px solid rgba(255,255,255,0.08);
      background: rgba(255,255,255,0.03);
      color: var(--text);
      font-size:15px;
      transition: box-shadow .18s ease, border-color .18s ease, transform .06s ease;
    }
    .field input::placeholder { color: rgba(255,255,255,0.28); font-weight:500 }
    .field input:focus, .field select:focus {
      outline:none;
      border-color: var(--vector);
      box-shadow: 0 6px 20px rgba(41,121,255,0.10);
      transform: translateY(-1px);
    }

    /* small helper info */
    .meta { font-size:13px;color:var(--muted); margin-top:8px }

    /* right column: preview & quick options */
    .panel {
      background: linear-gradient(180deg, rgba(255,255,255,0.01), transparent);
      border-radius: 10px;
      padding: 14px;
      border:1px solid rgba(255,255,255,0.03);
      min-height: 160px;
      display:flex;flex-direction:column;gap:12px;
      align-items:stretch;
    }
    .panel h3 { margin:0;font-size:14px }
    .panel .preview {
      height:100px;border-radius:8px;background:linear-gradient(180deg,#07121b, #0b2430);
      display:flex;align-items:center;justify-content:center;color:var(--muted); font-size:14px;
      border:1px dashed rgba(255,255,255,0.02);
    }

    /* actions */
    .actions {
      display:flex;gap:12px;justify-content:flex-end;margin-top:8px;
    }
    .btn {
      border:0;padding:10px 16px;border-radius:10px;font-weight:700;cursor:pointer;font-size:15px;
    }
    .btn.secondary {
      background: rgba(255,255,255,0.06);
      color:var(--text);
      box-shadow: 0 6px 16px rgba(0,0,0,0.35);
    }
    .btn.primary {
      background: linear-gradient(180deg,var(--vector), #005ed6);
      color: #fff;
      box-shadow: 0 14px 30px rgba(41,121,255,0.20);
      transform-style: preserve-3d;
    }
    .btn:hover { transform: translateY(-3px) }

    /* subtle helper row under actions */
    .note { color:var(--muted); font-size:13px; margin-top:10px }

    /* responsive */
    @media (max-width: 980px) {
      .ws-form { grid-template-columns: 1fr; }
      .workspace-card { padding: 22px; width: calc(100% - 40px) }
      .workspace-card p.lead { max-width:100% }
      .panel { order: 2; }
    }

    @media (prefers-reduced-motion: reduce) {
      .workspace-card, .cinema-bg { animation: none; transition: none !important; }
    }
    /* --------------------------
   CINEMATIC MODAL SYSTEM
---------------------------*/

.ws-actions {
  display:flex;
  gap:12px;
  margin:16px 0 26px 0;
}

.ws-btn {
  padding:10px 18px;
  border-radius:10px;
  border:1px solid rgba(255,255,255,0.1);
  background:rgba(255,255,255,0.04);
  color:var(--text);
  cursor:pointer;
  font-size:14px;
  font-weight:600;
  transition:0.25s ease;
  box-shadow:0 4px 14px rgba(0,0,0,0.35);
}

.ws-btn:hover {
  background:rgba(41,121,255,0.12);
  transform:translateY(-2px);
}

/* Backdrop */
.indigis-modal-backdrop {
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.55);
  backdrop-filter: blur(8px);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:9999;
  animation:fadeIn .4s ease forwards;
}

@keyframes fadeIn {
  from { opacity:0; }
  to   { opacity:1; }
}

/* Modal box */
.indigis-modal {
  width:420px;
  background:rgba(255,255,255,0.06);
  border-radius:16px;
  padding:34px;
  text-align:center;
  border:1px solid rgba(255,255,255,0.12);
  box-shadow:0 20px 60px rgba(0,0,0,0.55);
  transform:scale(0.85) translateY(20px);
  opacity:0;
  animation:popUp .45s cubic-bezier(.15,.9,.2,1) forwards;
}

@keyframes popUp {
  to {
    opacity:1;
    transform:scale(1) translateY(0);
  }
}

/* Icon area */
.modal-icon {
  position:relative;
  width:82px;
  height:82px;
  margin:0 auto 12px;
}

.modal-icon span {
  font-size:38px;
  position:relative;
  z-index:2;
}

/* Glow Pulse */
.pulse {
  position:absolute;
  inset:0;
  border-radius:50%;
  background: radial-gradient(circle, rgba(41,121,255,0.45), rgba(123,97,255,0.25));
  animation:pulse 2.4s infinite ease-in-out;
  filter:blur(4px);
}

@keyframes pulse {
  0% { transform:scale(0.9); opacity:0.5; }
  50% { transform:scale(1.15); opacity:0.9; }
  100% { transform:scale(0.9); opacity:0.5; }
}

.indigis-modal h2 {
  margin-top:6px;
  font-size:22px;
}

.indigis-modal p {
  font-size:14px;
  color:var(--muted);
  margin-top:6px;
  line-height:1.5;
}

/* Close button */
.modal-close {
  margin-top:20px;
  padding:10px 24px;
  border:0;
  border-radius:10px;
  font-weight:700;
  background:linear-gradient(180deg,var(--vector),#005ed6);
  color:white;
  cursor:pointer;
  box-shadow:0 10px 30px rgba(41,121,255,0.28);
  transition:0.25s ease;
}

.modal-close:hover {
  transform:translateY(-2px);
}

  </style>
</head>

<body>
  <!-- cinematic decorative layer -->
  <div class="cinema-bg" aria-hidden="true"></div>
  <div class="watermark">INDIGIS</div>

  <!-- small top brand -->
  <div class="brand-header" aria-hidden="true">
   <div class="brand-mark">
  <img src="assets/logo.png" alt="INDIGIS logo">
</div>

      <div class="brand-title">INDIGIS</div>
      <div class="brand-sub">Geospatial Intelligence Platform</div>
    </div>
  </div>

  <div class="workspace-screen" role="main">
    <div class="workspace-card" aria-labelledby="wsTitle">

      <div class="top">
        <div style="flex:1">
          <h2 id="wsTitle">Create / Open Workspace</h2>
          <p class="lead">Set workspace name, default base map and projection. This step is required before opening the main application. You can change these later in the app settings.</p>
          <div class="ws-actions">
            <button type="button" class="ws-btn" id="newWsBtn">ðŸª„ New Workspace</button>
            <button type="button" class="ws-btn" id="openWsBtn">ðŸ“‚ Open Workspace</button>
            <button type="button" class="ws-btn" id="recentWsBtn">ðŸ•˜ Recent Workspace</button>
</div>

        </div>
      </div>

      <form id="workspaceForm" class="ws-form" autocomplete="on" novalidate>
        <!-- LEFT: fields -->
        <div class="form-stack" aria-hidden="false">

          <div class="field">
            <label for="wsName">Workspace name</label>
            <input id="wsName" name="wsName" placeholder="My Project X" required aria-required="true" />
          </div>

         <div class="field" style="display:flex;gap:12px">
  <div style="flex:1">
    <label for="basemap">Base map</label>
    <select id="basemap" name="basemap">
      <option value="osm">OpenStreetMap</option>
      <option value="sat">Satellite</option>
      <option value="dark">Dark</option>
      <option value="terrain">Terrain</option>
    </select>
  </div>

  <div style="width:170px">
    <label for="proj">Projection</label>
    <select id="proj" name="proj">
      <option value="webmercator">WebMercator (EPSG:3857)</option>
      <option value="epsg4326">EPSG:4326</option>
      <option value="epsg32643">EPSG:32643</option>
    </select>
  </div>

  <div style="width:170px">
    <label for="userMode">User mode</label>
    <select id="userMode" name="userMode">
      <option value="basic">Basic</option>
      <option value="intermediate">Intermediate</option>
      <option value="advanced">Advanced</option>
    </select>
  </div>
</div>



          <div class="meta">Tip: use a short descriptive name (e.g. "LULC_2025").</div>
        </div>

        <!-- RIGHT: preview / quick actions -->
        <aside class="panel" aria-label="Quick preview and options">
          <h3>Workspace Preview</h3>
          <div class="preview" id="wsPreview">Preview: OpenStreetMap â€¢ EPSG:3857</div>

          <div style="display:flex;gap:8px;margin-top:8px">
            <button type="button" class="btn secondary" id="importBtn" title="Import settings">Import</button>
            <button type="button" class="btn secondary" id="templatesBtn" title="Load template">Templates</button>
          </div>

          <div style="margin-top:auto">
            <div class="note">Workspaces are saved locally in your browser. Use export to share configuration.</div>
          </div>
        </aside>
      </form>

      <div style="display:flex;justify-content:flex-end;align-items:center;margin-top:18px;gap:12px">
        <button class="btn secondary" id="backBtn">Back to Login</button>
        <button class="btn primary" id="createBtn">Create & Open App</button>
      </div>

    </div>
  </div>

  <script>
    // ===== cinematic modal demo (attach only once) =====
(function() {
  // Modal elements (will be present in DOM after page load)
  // We use getElementById below; ensure modal HTML is placed before </body> (it is)
  function qs(id) { return document.getElementById(id); }

  const newBtn = qs("newWsBtn");
  const openBtn = qs("openWsBtn");
  const recentBtn = qs("recentWsBtn");

  // openDemo will be defined later after modal exists in DOM; we will connect handlers once DOMContentLoaded
  function attachHandlers() {
    const modalBackdrop = qs("modalBackdrop");
    const modalEmoji = qs("modalEmoji");
    const modalTitle = qs("modalTitle");
    const modalDesc = qs("modalDesc");
    const closeModalBtn = qs("closeModalBtn");

    function openDemo(icon, title, desc) {
      if (!modalBackdrop) return;
      if (modalEmoji) modalEmoji.textContent = icon;
      if (modalTitle) modalTitle.textContent = title;
      if (modalDesc) modalDesc.textContent = desc;
      modalBackdrop.style.display = "flex";
    }

    function closeDemo() {
      if (modalBackdrop) modalBackdrop.style.display = "none";
    }

    if (closeModalBtn) closeModalBtn.addEventListener("click", closeDemo);
    if (modalBackdrop) modalBackdrop.addEventListener("click", function(e){
      if (e.target === modalBackdrop) closeDemo();
    });

    if (newBtn) newBtn.addEventListener("click", function() {
      openDemo("ðŸª„",
        "New Workspace â€” Demo",
        "1ï¸âƒ£ Enter workspace name\n2ï¸âƒ£ Select basemap & projection\n3ï¸âƒ£ Click Create Workspace");
    });

    if (openBtn) openBtn.addEventListener("click", function() {
      openDemo("ðŸ“‚",
        "Open Workspace â€” Demo",
        "1ï¸âƒ£ Shows list of saved workspaces\n2ï¸âƒ£ User selects workspace\n3ï¸âƒ£ Workspace loads with previous settings");
    });

    if (recentBtn) recentBtn.addEventListener("click", function() {
      openDemo("ðŸ•˜",
        "Recent Workspaces â€” Demo",
        "1ï¸âƒ£ Displays last 5 workspaces\n2ï¸âƒ£ User picks one\n3ï¸âƒ£ App resumes immediately");
    });
  }

  // ensure modal elements exist - wait for DOM content
  if (document.readyState === "loading") {
    document.addEventListener("DOMContentLoaded", attachHandlers);
  } else {
    attachHandlers();
  }
})();

    // --- preserve original app logic, updated to match new structure ---
    if (localStorage.getItem('indigis_logged_in') !== 'true') {
      // not logged in -> go back
      window.location.href = 'index.html';
    }

    // helpers
    const wsName = document.getElementById('wsName');
    const basemap = document.getElementById('basemap');
    const proj = document.getElementById('proj');
    const preview = document.getElementById('wsPreview');
    const userMode = document.getElementById('userMode');

 function updatePreview() {
  const bm =
    basemap.value === 'osm' ? 'OpenStreetMap' :
    basemap.value === 'sat' ? 'Satellite' :
    basemap.value === 'dark' ? 'Dark' :
    basemap.value === 'terrain' ? 'Terrain' : basemap.value;

  const pr = proj.value;
  const mode = userMode.value;

  preview.textContent = `Preview: ${bm} â€¢ ${pr} â€¢ ${mode.toUpperCase()} mode`;
}

    // restore existing workspace values if present
    document.addEventListener('DOMContentLoaded', () => {
      const ws = localStorage.getItem('indigis_workspace_data');
      if (ws) {
        try {
          const obj = JSON.parse(ws);
          wsName.value = obj.name || '';
          basemap.value = obj.basemap || 'osm';
          proj.value = obj.proj || 'webmercator';
          userMode.value = obj.userMode || 'basic';
        } catch(e) { /* ignore */ }
      }
      updatePreview();
      // keyboard: Enter in name -> create
      wsName.addEventListener('keydown', (ev) => {
        if (ev.key === 'Enter') document.getElementById('createBtn').click();
      });
    });

    // live preview updates
    basemap.addEventListener('change', updatePreview);
    proj.addEventListener('change', updatePreview);

    // create action (same behavior)
    document.getElementById('createBtn').addEventListener('click', (ev) => {
      const name = wsName.value.trim();
      if (!name) {
        wsName.focus();
        // small inline friendly message instead of alert
        const prev = preview;
        const old = prev.textContent;
        prev.textContent = 'Please enter a workspace name';
        prev.style.color = '#FFB6B6';
        setTimeout(()=>{ prev.textContent = old; prev.style.color = ''; }, 1800);
        return;
      }
      const data = { name, basemap: basemap.value, proj: proj.value, createdAt: new Date().toISOString() };
      localStorage.setItem('indigis_workspace_data', JSON.stringify(data));
      localStorage.setItem('indigis_workspace_created', 'true');
      // go to main app
     const data1 = {
  name,
  basemap: basemap.value,
  proj: proj.value,
  userMode: userMode.value,
  createdAt: new Date().toISOString()
};

localStorage.setItem('indigis_workspace_data', JSON.stringify(data));
localStorage.setItem('indigis_workspace_created', 'true');

switch (userMode.value) {
  case 'basic':
    window.location.href = './basic/basic.html';
    break;

  case 'intermediate':
    window.location.href = './intermediate/intermediate.html';
    break;

  case 'advanced':
    window.location.href = './advanced/advanced.html';
    break;
}


    });
userMode.addEventListener('change', updatePreview);

    // back button
    document.getElementById('backBtn').addEventListener('click', () => {
      window.location.href = 'index.html';
    });

    // optional quick actions (placeholders for future)
    document.getElementById('importBtn').addEventListener('click', () => {
      alert('Import settings (coming soon)');
    });
    document.getElementById('templatesBtn').addEventListener('click', () => {
      alert('Workspace templates (coming soon)');
    });
  </script>

  <!-- CINEMATIC MODAL (placed outside script, before </body>) -->
  <div class="indigis-modal-backdrop" id="modalBackdrop" aria="true">
    <div class="indigis-modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
      <div class="modal-icon" aria="true">
        <div class="pulse" aria="true"></div>
        <span id="modalEmoji">âœ¨</span>
      </div>

      <h2 id="modalTitle">Title</h2>
      <p id="modalDesc">Description goes here.</p>

      <button class="modal-close" id="closeModalBtn" type="button">Close</button>
    </div>
  </div>

</body>
</html>
