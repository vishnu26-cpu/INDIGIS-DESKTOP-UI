<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>INDIGIS â€” App</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <script>
    // guard: must be logged in
    if (localStorage.getItem('indigis_logged_in') !== 'true') {
      window.location.href = 'index.html';
    }
    // guard: must have workspace created
    if (localStorage.getItem('indigis_workspace_created') !== 'true') {
      window.location.href = 'workspace.html';
    }
  </script>

  <div id="app" class="theme-auto">
    <!-- top hud simplified -->
    <header class="top-hud">
      <div class="hud-left"><div class="logo">INDIGIS <span class="brand">Prototype</span></div></div>
      <div class="hud-right">
        <button id="logoutBtn" class="icon-btn">ðŸšª</button>
      </div>
    </header>

    <div class="main-area">
      <aside class="left-panel">
        <div class="panel">
          <div class="panel-header">Layers</div>
          <div class="panel-body">
            <ul class="layer-list">
              <li><span class="chip vector">Base Map</span></li>
              <li><span class="chip vector">Points</span></li>
              <li><span class="chip raster">Raster</span></li>
            </ul>
          </div>
        </div>
      </aside>

      <main class="map-area">
        <div class="map-toolbar"><div>Map View</div></div>
        <div class="map-canvas"><div class="map-placeholder">Map canvas (OpenLayers / Cesium here)</div></div>
      </main>

      <aside class="right-panel">
        <div class="panel"><div class="panel-header">Inspector</div><div class="panel-body">No selection</div></div>
      </aside>
    </div>

    <footer class="status-ribbon">
      <div class="status-left">
        <span id="coords">Lat: â€” , Lon: â€”</span>
        <span>|</span><span id="proj">Proj: â€”</span>
      </div>
      <div class="status-right"><span>Scale 1: <strong id="scale">â€”</strong></span></div>
    </footer>
  </div>

  <script>
    // logout
    document.addEventListener('click', (e) => {
      if (e.target && e.target.id === 'logoutBtn') {
        localStorage.removeItem('indigis_logged_in');
        // optionally clear workspace too:
        // localStorage.removeItem('indigis_workspace_created');
        // localStorage.removeItem('indigis_workspace_data');
        window.location.href = 'index.html';
      }
    });

    // show workspace info in footer
    document.addEventListener('DOMContentLoaded', () => {
      const data = localStorage.getItem('indigis_workspace_data');
      if (data) {
        try {
          const obj = JSON.parse(data);
          document.getElementById('proj').textContent = 'Proj: ' + (obj.proj || 'â€”');
        } catch(e){}
      }
    });
  </script>
</body>
</html>
